{"version":3,"sources":["file:///E:/04Project/Cocos/Portal/assets/script/v2/CamCtrl.ts"],"names":["_decorator","Component","Camera","MeshRenderer","RenderTexture","Material","ccclass","property","CamCtrl","start","renderTex","reset","width","height","cameraComp","getComponent","targetTexture","pass","target","material","passes","defines","SAMPLE_FROM_RT","renderMat","initialize","effectAsset","setMaterial","setProperty"],"mappings":";;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,Y,OAAAA,Y;AAAcC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,Q,OAAAA,Q;;;;;;;;;OAC/D;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;yBAGjBQ,O,WADZF,OAAO,CAAC,SAAD,C,UAIHC,QAAQ,CAACJ,YAAD,C,2BAJb,MACaK,OADb,SAC6BP,SAD7B,CACuC;AAAA;AAAA;;AAAA;AAAA;;AAMnCQ,QAAAA,KAAK,GAAG;AACJ,gBAAMC,SAAS,GAAG,IAAIN,aAAJ,EAAlB,CADI,CACkC;;AACtCM,UAAAA,SAAS,CAACC,KAAV,CAAgB;AAAC;AACbC,YAAAA,KAAK,EAAE,IADK;AAEZC,YAAAA,MAAM,EAAE;AAFI,WAAhB;AAIA,gBAAMC,UAAU,GAAG,KAAKC,YAAL,CAAkBb,MAAlB,CAAnB,CANI,CAMyC;;AAC7CY,UAAAA,UAAU,CAACE,aAAX,GAA2BN,SAA3B,CAPI,CAOiC;;AACrC,gBAAMO,IAAI,GAAG,KAAKC,MAAL,CAAYC,QAAZ,CAAqBC,MAArB,CAA4B,CAA5B,CAAb,CARI,CAQwC;;AAC5C,gBAAMC,OAAO,GAAG;AAAEC,YAAAA,cAAc,EAAE,IAAlB;AAAwB,eAAGL,IAAI,CAACI;AAAhC,WAAhB;AACA,gBAAME,SAAS,GAAG,IAAIlB,QAAJ,EAAlB,CAVI,CAU6B;;AACjCkB,UAAAA,SAAS,CAACC,UAAV,CAAqB;AAAC;AAClBC,YAAAA,WAAW,EAAE,KAAKP,MAAL,CAAYC,QAAZ,CAAqBM,WADjB;AAEjBJ,YAAAA;AAFiB,WAArB;AAIA,eAAKH,MAAL,CAAYQ,WAAZ,CAAwBH,SAAxB,EAAmC,CAAnC,EAfI,CAekC;;AACtCA,UAAAA,SAAS,CAACI,WAAV,CAAsB,aAAtB,EAAqCjB,SAArC,EAAgD,CAAhD,EAhBI,CAgB+C;AAEtD;;AAxBkC,O;;;;;iBAIb,I","sourcesContent":["// 本文件代码源自https://forum.cocos.org/t/topic/121977\nimport { _decorator, Component, Camera, MeshRenderer, RenderTexture, Material } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('CamCtrl')\nexport class CamCtrl extends Component {\n\n    // 材质\n    @property(MeshRenderer)\n    target:MeshRenderer = null;\n\n    start() {\n        const renderTex = new RenderTexture();//渲染贴图\n        renderTex.reset({//初始化参数\n            width: 1024,\n            height: 1024\n        });\n        const cameraComp = this.getComponent(Camera);//获取摄像机\n        cameraComp.targetTexture = renderTex;//设置目标贴图\n        const pass = this.target.material.passes[0];//设置pass\n        const defines = { SAMPLE_FROM_RT: true, ...pass.defines };\n        const renderMat = new Material();//材质\n        renderMat.initialize({//初始化参数\n            effectAsset: this.target.material.effectAsset,\n            defines,\n        });\n        this.target.setMaterial(renderMat, 0);//设置材质\n        renderMat.setProperty('mainTexture', renderTex, 0);//设置参数\n\n    }\n}\n\n"]}