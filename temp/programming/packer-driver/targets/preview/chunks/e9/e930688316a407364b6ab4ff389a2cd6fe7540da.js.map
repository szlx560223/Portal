{"version":3,"sources":["file:///E:/04Project/Cocos/Portal/assets/script/v1/CamCtrl.ts"],"names":["_decorator","Component","Node","v3","director","macro","ccclass","property","l","console","log","CamCtrl","distance","doorPos","camPos","rts","start","schedule","getScheduler","Door","worldPosition","MainCamera","clone","subtract","getWorldRotation","getEulerAngles","y","node","setWorldPosition","setRotationFromEuler","x","z","REPEAT_FOREVER","logInfo","event"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAYC,MAAAA,E,OAAAA,E;AAAWC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,K,OAAAA,K;;;;;;;;;OAC3D;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;AACxBQ,MAAAA,C,GAAIC,OAAO,CAACC,G;;yBAGLC,O,WADZL,OAAO,CAAC,SAAD,C,UAGHC,QAAQ,CAACL,IAAD,C,UAGRK,QAAQ,CAACL,IAAD,C,2BANb,MACaS,OADb,SAC6BV,SAD7B,CACuC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAQ3BW,QAR2B,GAQXT,EAAE,EARS;AAAA,eAU3BU,OAV2B,GAUZV,EAAE,EAVU;AAAA,eAY3BW,MAZ2B,GAYbX,EAAE,EAZW;AAAA,eAc3BY,GAd2B,GAchBZ,EAAE,EAdc;AAAA;;AAgBnCa,QAAAA,KAAK,GAAE;AACH,cAAIC,QAAQ,GAAGb,QAAQ,CAACc,YAAT,EAAf;AACAD,UAAAA,QAAQ,CAACA,QAAT,CAAkB,MAAI;AAClB,iBAAKJ,OAAL,GAAe,KAAKM,IAAL,CAAUC,aAAzB;AACA,iBAAKN,MAAL,GAAc,KAAKO,UAAL,CAAgBD,aAA9B;AACA,iBAAKR,QAAL,GAAgB,KAAKE,MAAL,CAAYQ,KAAZ,GAAoBC,QAApB,CAA6B,KAAKV,OAAlC,CAAhB;AACA,iBAAKQ,UAAL,CAAgBG,gBAAhB,GAAmCC,cAAnC,CAAkD,KAAKV,GAAvD;AACA,iBAAKA,GAAL,CAASW,CAAT,GAAa,KAAKX,GAAL,CAASW,CAAT,GAAW,GAAxB;AACA,iBAAKd,QAAL,CAAcc,CAAd,GAAkB,CAAC,KAAKd,QAAL,CAAcc,CAAjC;AACA,iBAAKC,IAAL,CAAUC,gBAAV,CAA2B,KAAKf,OAAL,CAAaS,KAAb,GAAqBC,QAArB,CAA8B,KAAKX,QAAnC,CAA3B;AACA,iBAAKe,IAAL,CAAUE,oBAAV,CAA+B,KAAKd,GAAL,CAASe,CAAxC,EAA0C,KAAKf,GAAL,CAASW,CAAnD,EAAqD,KAAKX,GAAL,CAASgB,CAA9D;AAEH,WAVD,EAUE,IAVF,EAUO,CAVP,EAUS1B,KAAK,CAAC2B,cAVf,EAU8B,CAV9B,EAUgC,KAVhC;AAYH;;AACDC,QAAAA,OAAO,CAACC,KAAD,EAAa;AAChB1B,UAAAA,CAAC,CAAC,KAAKI,QAAN,CAAD;AACH;;AAjCkC,O;;;;;iBAGjB,I;;;;;;;iBAGN,I","sourcesContent":["import { _decorator, Component, Node, Vec3, v3, Event, director, macro, Quat } from 'cc';\nconst { ccclass, property } = _decorator;\nconst l = console.log\n\n@ccclass('CamCtrl')\nexport class CamCtrl extends Component {\n    //主摄像机\n    @property(Node)\n    MainCamera:Node = null;\n    //传送门\n    @property(Node)\n    Door:Node = null;\n    //相对距离\n    private distance:Vec3 = v3();\n    //门的位置\n    private doorPos:Vec3 = v3();\n    //摄像机位置\n    private camPos:Vec3 = v3();\n    //欧拉角朝向\n    private rts:Vec3 = v3();\n\n    start(){\n        let schedule = director.getScheduler();\n        schedule.schedule(()=>{\n            this.doorPos = this.Door.worldPosition;\n            this.camPos = this.MainCamera.worldPosition;\n            this.distance = this.camPos.clone().subtract(this.doorPos);\n            this.MainCamera.getWorldRotation().getEulerAngles(this.rts);\n            this.rts.y = this.rts.y+180;\n            this.distance.y = -this.distance.y;\n            this.node.setWorldPosition(this.doorPos.clone().subtract(this.distance));\n            this.node.setRotationFromEuler(this.rts.x,this.rts.y,this.rts.z)\n\n        },this,0,macro.REPEAT_FOREVER,0,false);\n\n    }\n    logInfo(event:Event){\n        l(this.distance)\n    }\n}\n\n"]}